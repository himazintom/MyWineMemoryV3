# Claude Code 権限・制限・エスカレーション基準

## ✅ Claude Code に許可する作業

### 完全自動化OK（人間の承認不要）
```markdown
### コード実装
- React コンポーネントの作成・修正
- TypeScript 型定義の作成・修正
- CSS/SCSS スタイルの実装
- テストコードの作成
- ユーティリティ関数の実装

### 設定ファイル
- package.json の依存関係追加
- tsconfig.json の調整
- eslint.config.js の調整
- vite.config.ts の調整（基本設定のみ）

### ドキュメント
- README.md の更新
- コードコメントの追加
- 技術ドキュメントの作成
- API ドキュメントの生成

### 品質管理
- リント修正
- フォーマット修正
- 型エラー修正
- テスト修正
```

### 条件付き許可（マネージャーClaude承認必要）
```markdown
### アーキテクチャ変更
- フォルダ構造の大幅変更
- 新しいライブラリの導入
- 設計パターンの変更
- データベース構造の変更

### パフォーマンス影響
- バンドルサイズに大きく影響する変更
- ビルド時間に影響する変更
- ランタイムパフォーマンスに影響する変更

### セキュリティ関連
- 認証ロジックの変更
- セキュリティルールの変更
- 暗号化・復号化の実装
- API キーの取り扱い変更
```

## ❌ Claude Code に禁止する作業

### 絶対禁止（人間のみ実行可能）
```markdown
### 外部サービス設定
- Firebase プロジェクトの作成・設定
- GitHub リポジトリの作成・設定
- ドメイン・DNS設定
- SSL証明書の設定
- 決済システム（Stripe）の設定

### 機密情報
- API キーの生成・設定
- 環境変数の本番設定
- サービスアカウントキーの生成
- パスワード・トークンの生成

### 本番環境操作
- 本番データベースの直接操作
- 本番環境へのデプロイ実行
- 本番ユーザーデータの操作
- 本番環境の設定変更

### 法的・ビジネス判断
- ライセンス選択
- プライバシーポリシー作成
- 利用規約作成
- 料金設定
- ビジネスロジックの重要な変更

### 外部連携
- 第三者APIとの契約・設定
- 外部サービスのアカウント作成
- 支払い情報の設定
- 法的文書への署名
```

## 🚨 エスカレーション基準

### 即座に人間に相談（作業停止）
```markdown
### 技術的判断
❌ "複数の実装方法があり、どれを選ぶべきか判断できません"
❌ "セキュリティ上のリスクが不明です"
❌ "パフォーマンスへの影響が予測できません"
❌ "ライセンス上の問題がある可能性があります"

### 外部依存
❌ "Firebase の設定が必要です"
❌ "GitHub の権限設定が必要です"
❌ "ドメインの設定が必要です"
❌ "有料サービスの契約が必要です"

### データ・セキュリティ
❌ "本番データにアクセスする必要があります"
❌ "機密情報の取り扱い方針が不明です"
❌ "セキュリティルールの変更が必要です"
❌ "暗号化方式の選択が必要です"
```

### チーム内で解決を試行（24時間以内）
```markdown
### 技術的問題
⚠️ "ライブラリの使用方法がわかりません"
⚠️ "エラーの原因が特定できません"
⚠️ "テストが失敗します"
⚠️ "ビルドエラーが発生します"

### 設計判断
⚠️ "コンポーネントの設計で迷っています"
⚠️ "データ構造の最適化について相談したいです"
⚠️ "パフォーマンス改善の方法を検討中です"

### 進捗・調整
⚠️ "他のClaude Codeとの作業調整が必要です"
⚠️ "タスクの優先順位を変更したいです"
⚠️ "予想より時間がかかっています"
```

## 🎯 人間の手作業が必要な項目

### 初期セットアップ（1回のみ）
```markdown
### Firebase プロジェクト
1. Firebase Console でプロジェクト作成
2. Authentication の有効化
3. Firestore の有効化
4. Storage の有効化
5. Hosting の有効化
6. API キーの取得・設定

### GitHub 設定
1. リポジトリ作成
2. Collaborator の招待
3. Branch protection rules 設定
4. Secrets の設定（API キー等）
5. GitHub Actions の有効化

### ドメイン・DNS
1. ドメインの取得
2. DNS レコードの設定
3. SSL証明書の設定
4. Firebase Hosting との連携
```

### 継続的な人間作業
```markdown
### 週次作業
- [ ] 進捗レビューと方針調整
- [ ] 品質メトリクスの確認
- [ ] リスク評価と対策検討

### 月次作業
- [ ] 外部サービス利用料金の確認
- [ ] セキュリティ監査
- [ ] パフォーマンス分析
- [ ] ユーザーフィードバックの分析

### 必要時作業
- [ ] 本番環境へのデプロイ承認
- [ ] 緊急時の障害対応
- [ ] 法的文書の確認・署名
- [ ] ビジネス要件の変更対応
```

## 📋 Claude Code からの相談フォーマット

### 技術的相談
```markdown
## 🤔 技術的判断が必要です

### 状況
現在、[具体的な状況]で作業中です。

### 選択肢
1. 方法A: [メリット・デメリット]
2. 方法B: [メリット・デメリット]
3. 方法C: [メリット・デメリット]

### 影響範囲
- パフォーマンス: [影響度]
- セキュリティ: [影響度]
- 保守性: [影響度]
- 開発効率: [影響度]

### 推奨案
Claude Code チームとしては[X]を推奨しますが、
[理由]により人間の判断を求めます。

### 緊急度
- [ ] 即座に必要（作業停止中）
- [ ] 24時間以内
- [ ] 今週中
- [ ] 来週まで待機可能
```

### 外部作業依頼
```markdown
## 🙋‍♂️ 人間の作業が必要です

### 必要な作業
[具体的な作業内容]

### 理由
Claude Code では[理由]により実行できません。

### 前提条件
この作業の完了により、以下のタスクが進行可能になります：
- タスク[番号]: [内容]
- タスク[番号]: [内容]

### 参考情報
- 設定手順: [URL or 手順]
- 必要な情報: [リスト]
- 注意事項: [重要なポイント]

### 緊急度
- [ ] 即座に必要（開発停止中）
- [ ] 24時間以内（他の作業に影響）
- [ ] 今週中（計画通り進行のため）
- [ ] 来週まで待機可能
```

## 🎯 成功のポイント

### Claude Code 側
1. **明確な境界**: 自分の権限範囲を理解し、超えない
2. **早期相談**: 判断に迷ったら早めに相談
3. **詳細な報告**: 状況と選択肢を明確に伝える
4. **継続的学習**: 人間のフィードバックから学習

### 人間側
1. **迅速な判断**: Claude Code の作業を止めないよう素早く対応
2. **明確な指示**: 判断基準と理由を明確に伝える
3. **権限委譲**: 可能な限りClaude Code に任せる
4. **定期的レビュー**: 権限範囲を定期的に見直し

この体制により、Claude Code チームが最大限の自律性を持ちながら、
重要な判断は人間が行う理想的な開発体制を実現できます。