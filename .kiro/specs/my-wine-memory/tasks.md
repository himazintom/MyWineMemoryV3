# MyWineMemory 実装タスク

## プロジェクト初期設定

- [x] 1. プロジェクト基盤構築


  - React 18 + TypeScript + Vite プロジェクトの初期化
  - 必要な依存関係のインストール（Firebase SDK、Chart.js、React Router等）
  - 基本的なフォルダ構造の作成（src/components, src/pages, src/services等）
  - _要件: 全体的な技術基盤_

- [x] 1.1 開発環境設定

  - [x] ESLint、Prettier、TypeScript設定ファイルの作成
  - [x] Vite設定ファイル（vite.config.ts）の作成とPWA設定
  - [x] 環境変数検証機能とvite-env.d.ts作成
  - [x] TypeScriptビルドエラー修正完了
  - _要件: 13.パフォーマンス最適化、21.運用・監視_


- [x] 1.2 Firebase プロジェクト設定

  - Firebase プロジェクトの作成と設定
  - Firestore、Authentication、Storage、Hostingの有効化
  - firebase.json設定ファイルの作成
  - _要件: 1.ユーザー認証システム_

## 認証システム実装

- [x] 2. Firebase認証基盤の実装
  - Firebase設定ファイル（src/services/firebase.ts）の作成
  - FirebaseServiceクラスのシングルトンパターン実装
  - 基本的な認証メソッド（Google OAuth）の実装
  - _要件: 1.ユーザー認証システム_

- [x] 2.1 AuthContextの実装
  - AuthContextとAuthProviderの作成
  - 認証状態管理（currentUser, userProfile, loading）
  - ゲストモード対応（localStorage利用）
  - _要件: 1.ユーザー認証システム_

- [x] 2.2 ユーザープロフィール管理
  - [x] Userデータモデルの型定義
  - [x] ユーザー作成・更新・取得機能の実装
  - [x] Firebase User → Firestore User の自動同期
  - [x] ProfilePageコンポーネントの実装
  - [x] ユーザープロフィール編集機能
  - _要件: 1.ユーザー認証システム_

- [x] 2.3 ゲストデータ移行機能
  - [x] ゲストデータの検出と要約機能
  - [x] ゲスト → 認証ユーザーへのデータ移行処理
  - [x] 移行完了後のローカルデータクリーンアップ
  - [x] LoginPageでのゲストデータ移行案内UI
  - [x] Firebase Batch処理での大量データ移行
  - _要件: 1.ユーザー認証システム_

## エラーハンドリング・共通機能

- [x] 3. エラーハンドリングシステム
  - [x] AppError型定義とErrorContextの実装
  - [x] Firebase エラー分類とユーザーフレンドリーメッセージ変換
  - [x] 指数バックオフによる自動リトライ機能
  - [x] ErrorHandlerサービスの完全実装（シングルトンパターン）
  - [x] 包括的エラー統計とコンテキスト管理
  - _要件: 11.エラーハンドリング・オフライン対応_

- [x] 3.1 共通UIコンポーネント
  - [x] LoadingSpinnerコンポーネントの作成
  - [x] ErrorMessageコンポーネントの作成（role="alert"対応）
  - [x] 基本的なButtonコンポーネントの作成
  - [x] ErrorBoundaryコンポーネントの作成
  - [x] TagInputコンポーネントの作成（タグ入力、削除機能）
  - _要件: 20.レスポンシブデザイン・アクセシビリティ_

- [x] 3.2 ルーティング設定
  - [x] React Router v7の設定
  - [x] 全ページコンポーネントのReact.lazy遅延読み込み
  - [x] ScrollToTopコンポーネントの実装
  - [x] LayoutコンポーネントとHeader、BottomNavigationの作成
  - _要件: 20.レスポンシブデザイン・アクセシビリティ_

## データモデル・サービス層

- [x] 4. データモデル定義
  - [x] TastingRecord型の完全な定義
  - [x] DetailedAnalysis、Environment、Citation型の定義
  - [x] QuizProgress、UserQuizStats型の定義
  - [x] DailyQuiz、2100問ワインクイズのデータ構造
  - [x] ゲーミフィケーション関連型の定義
  - [x] types/index.tsでの統合エクスポート完了
  - _要件: 2.ワインテイスティング記録システム、4.ワインクイズ学習システム_

- [x] 4.1 TastingRecordService実装
  - [x] 基本CRUD操作（create, get, update, delete）の実装
  - [x] ユーザー記録取得とフィルタリング機能（ページネーション対応）
  - [x] 人気ワイン取得機能（上位10件、記録数・平均評価・最終テイスティング日付）
  - [x] 複合条件検索（国、地域、品種、価格帯、日付範囲、ワイン名、生産者）
  - [x] ユーザー統計機能（総記録数、平均評価、好きな国・タイプ、月別記録数、評価分布）
  - [x] 類似ワイン検索（重複検出用、信頼度スコア付き）
  - _要件: 2.ワインテイスティング記録システム、3.ワイン記録管理・検索システム_

- [x] 4.2 画像アップロード機能
  - [x] WebP変換とフォールバック処理の実装
  - [x] 画像最適化（圧縮、リサイズ）機能
  - [x] Firebase Storageへのアップロード処理
  - [x] ドラッグ&ドロップ対応UIコンポーネント
  - [x] プレミアムプラン制限（無料1枚、プレミアム4枚）
  - _要件: 2.ワインテイスティング記録システム、13.パフォーマンス最適化_

- [x] 4.3 検索・フィルタリング機能
  - [x] デバウンス検索（300ms）の実装
  - [x] 複合条件検索（国、地域、品種、価格帯等）
  - [x] 重複ワイン検出機能
  - [x] searchService.ts、useDebounceSearch.ts、SearchBar.tsx実装完了
  - _要件: 3.ワイン記録管理・検索システム_

## ワイン記録UI実装

- [x] 5. ワイン選択ページ（SelectWine）
  - [x] 人気ワイン表示コンポーネント（上位20件、記録数・平均評価・最終記録表示）
  - [x] リアルタイム検索フォーム（useDebounceSearchフック、300ms遅延）
  - [x] 新規ワイン作成フォーム（完全なワイン情報入力、PopularWine形式変換）
  - [x] ユーザー認証状態チェックとエラーハンドリング
  - [x] アクセシビリティ対応（キーボードナビゲーション、ARIA属性）
  - _要件: 2.ワインテイスティング記録システム_

- [x] 5.1 TagInputコンポーネント
  - [x] Enter/カンマ区切り入力機能
  - [x] タグ削除機能（Backspace + 個別削除ボタン）
  - [x] 重複防止とフォーカス管理
  - _要件: 2.ワインテイスティング記録システム_

- [x] 5.2 テイスティング記録ページ（AddTastingRecord）
  - [x] クイック・詳細モード切り替えUI（2つのモード、動的フォーム切り替え）
  - [x] 基本情報入力フォーム（ワイン名、生産者、国、地域、価格等）
  - [x] 評価入力（0.0-10.0スケール）とメモ入力
  - [x] 詳細分析フォーム（外観、香り、味わい、構造の包括的分析）
  - [x] 画像アップロード機能（ドラッグ&ドロップ、プレミアム制限）
  - [x] 手描きキャンバス統合とXPシステム連携
  - [x] 類似ワイン検出と警告表示機能
  - _要件: 2.ワインテイスティング記録システム_

- [x] 5.3 詳細分析フォーム
  - [x] 外観分析入力（色、強度、透明度、粘性）
  - [x] 香り分析入力（第一印象、スワリング後、カテゴリー別評価）
  - [x] 味わい分析入力（アタック、展開、フィニッシュ）
  - [x] 構造分析入力（酸味、タンニン、甘味、ボディ）
  - [x] AddTastingRecordPageに統合済み
  - _要件: 2.ワインテイスティング記録システム_

- [x] 5.4 環境・コンテキスト記録
  - [x] グラスタイプ選択（8種類、画像付き）
  - [x] 環境情報入力（温度、デカンタ、照明、気分等）
  - [x] 時系列テイスティングノート機能
  - [x] AddTastingRecordPageのenvironmentセクション
  - _要件: 18.グラスタイプ選択・環境記録、19.時系列テイスティング・変化記録_

## 手描きキャンバス機能

- [x] 6. DrawingCanvasコンポーネント
  - [x] HTML5 Canvasを使用した描画機能
  - [x] ペン・消しゴムツールの切り替え
  - [x] ブラシサイズ調整（1-20px）とカラーピッカー
  - [x] 10色プリセットカラー機能
  - _要件: 17.手描きキャンバス・視覚的記録_

- [x] 6.1 描画機能の実装
  - [x] マウス・タッチイベントの統一処理
  - [x] アンドゥ・リドゥ機能（20ステップ履歴）
  - [x] PNG形式でのData URL出力
  - [x] 背景の白設定と初期画像読み込み対応
  - _要件: 17.手描きキャンバス・視覚的記録_

## 記録閲覧・管理UI

- [x] 7. 記録一覧ページ（Records）
  - [x] ワイン別グループ表示（groupBy: 'wine'オプション）
  - [x] 日付ソート機能（sortBy, sortOrder実装済み）
  - [x] 公開・非公開切り替え（showPublicOnly）
  - [x] RecordsPageコンポーネント実装済み
  - _要件: 3.ワイン記録管理・検索システム_

- [x] 7.1 WineFilterコンポーネント
  - [x] 4タブUI（種類・産地品種・価格年代・評価・その他）
  - [x] 動的候補表示（ユーザーデータ基準）
  - [x] アクティブフィルター表示とリアルタイムカウント
  - [x] キーワード検索と複数条件フィルタリング
  - _要件: 3.ワイン記録管理・検索システム_

- [x] 7.2 個別ワイン詳細ページ（RecordDetail）
  - [x] 完全なテイスティング情報表示
  - [x] 記録の編集・削除機能（所有者のみ）
  - [x] 削除確認モーダルと権限チェック
  - [x] 詳細分析データの全面表示
  - _要件: 3.ワイン記録管理・検索システム_

## 統計・分析機能

- [x] 8. TastingAnalysisChartsコンポーネント
  - [x] Chart.js統合とレーダーチャート（成分バランス）
  - [x] 棒グラフ（香りカテゴリー）の実装
  - [x] 線グラフ（味わいの展開）の実装
  - [x] Doughnut、Bar、Line、Radarチャート完全実装
  - _要件: 15.統計・分析ダッシュボード_

- [x] 8.1 統計ページ（Stats）
  - [x] Chart.js統合とStatsChartsコンポーネント
  - [x] 月別記録数グラフ（線グラフ）
  - [x] 国別・タイプ別分布円グラフ
  - [x] 評価分布バーチャートと統計カード
  - _要件: 15.統計・分析ダッシュボード_

- [x] 8.2 統計データ計算サービス
  - [x] リアルタイム統計計算機能
  - [x] キャッシュ機能による高速化（30分間タイムアウト）
  - [x] 年間サマリー生成機能
  - [x] statisticsService.ts、useStatistics.ts、StatisticsDashboard.tsx実装完了
  - _要件: 15.統計・分析ダッシュボード_

## クイズシステム実装

- [x] 9. クイズデータ構造
  - [x] 20レベル × 100問 = 2,000問のデータ構造実装完了
  - [x] QuizQuestion型定義（4択選択式 + 解説）
  - [x] レベル別動的読み込みシステム（dynamic import対応）
  - [x] 全レベル問題データ実装済み（level01-basic.ts～level20-philosophy.ts）
  - _要件: 4.ワインクイズ学習システム_

- [x] 9.1 QuizServiceの実装
  - [x] レベル別問題動的読み込み機能（1-20レベル、dynamic import）
  - [x] 問題キャッシュ機能（Map-based cache system）
  - [x] 進捗管理（完了問題、正解数、ベストスコア、ハートシステム）
  - [x] クイズセッション管理（開始・回答記録・完了）
  - [x] ハートシステム（5ハート、30分回復、消費・回復チェック）
  - [x] レベルアンロック機能（80%スコアで次レベル解放）
  - [x] XP計算とレベル別ボーナス
  - _要件: 4.ワインクイズ学習システム_

- [x] 9.2 クイズメニューページ（Quiz）
  - [x] レベル選択UIとハートシステム表示
  - [x] 進捗バーとスコア表示
  - [x] ワンノックイズセクション
  - _要件: 4.ワインクイズ学習システム_

- [x] 9.3 クイズゲームページ（QuizGame）
  - [x] 4択選択式UIとハートシステム
  - [x] 正解・不正解の即座フィードバック
  - [x] 解説とヒント表示機能
  - [x] セッション管理とスコア計算
  - _要件: 4.ワインクイズ学習システム_

## ハートシステム・進捗管理

- [x] 10. ハートシステム実装
  - [x] 5ライフ制の実装
  - [x] 30分回復間隔の管理
  - [x] ハート消費・回復の視覚的表示
  - [x] HeartSystem.tsx、HeartDisplay.tsx実装完了
  - _要件: 4.ワインクイズ学習システム_

- [x] 10.1 学習進捗管理
  - [x] 間違い復習システム（間隔反復学習、spaced repetition）
  - [x] ストリーク追跡（連続正解検出）
  - [x] 全体正解率の計算と表示
  - [x] learningProgressService.ts実装完了
  - _要件: 4.ワインクイズ学習システム_

## ゲーミフィケーション実装

- [x] 11. XPシステム実装
  - [x] 行動別XP付与（記録作成：10-20XP、クイズ正解：5XP、レベルアップ：25XP）
  - [x] レベル計算（指数進行、1.2倍）
  - [x] XP履歴の記録と表示（XPRecord型）
  - [x] レベルアップ記録とレベル履歴管理
  - [x] XP源泉別追跡（8種類のXPSource）
  - _要件: 5.ゲーミフィケーション・進捗管理システム_

- [x] 11.1 バッジシステム実装
  - [x] バッジ定義システム（4カテゴリー：tasting, quiz, social, achievement）
  - [x] バッジレア度システム（common, rare, epic, legendary）
  - [x] 獲得条件自動チェック（6種類のRequirementType）
  - [x] バッジ獲得時のXPボーナス（25XP）
  - [x] ユーザーバッジ管理とアクティビティ記録
  - バッジ獲得条件の自動チェック
  - バッジ獲得通知とアニメーション
  - _要件: 5.ゲーミフィケーション・進捗管理システム_

- [x] 11.2 日常目標システム
  - [x] 記録作成・クイズの目標設定（デフォルト：テイスティング1件、クイズ5問）
  - [x] 目標達成状況の追跡（日別進捗管理）
  - [x] 達成時のボーナスXP付与（30XP）
  - [x] 自動目標作成とストリーク管理
  - [x] ユーザーストリーク追跡（tasting, quiz, login別々に管理）
  - [x] アクティビティ記録とユーザー履歴
  - _要件: 5.ゲーミフィケーション・進捗管理システム_

- [x] 11.3 プロフィールページ（Profile）
  - [x] ユーザー統計表示（レベル、XP、バッジ）
  - [x] 獲得バッジ一覧
  - [x] アクティビティ履歴
  - [x] ProfilePageEnhanced.tsx実装完了
  - _要件: 5.ゲーミフィケーション・進捗管理システム_

## 過去記録引用システム

- [x] 12. 引用システム基盤
  - [x] 類似ワイン検索機能（Jaro-Winkler距離による類似度計算）
  - [x] 引用可能フィールドの表示
  - [x] 引用プレビュー機能
  - [x] CitationServiceクラス実装
  - _要件: 10.過去記録引用システム_

- [x] 12.1 引用UI実装
  - [x] 過去記録選択インターフェース（3ステップUI）
  - [x] フィールド選択チェックボックス
  - [x] 競合フィールドの警告表示
  - [x] CitationModalコンポーネント実装
  - _要件: 10.過去記録引用システム_

- [x] 12.2 引用履歴管理
  - [x] 引用元・引用先の関係記録
  - [x] 被引用回数の追跡
  - [x] 引用統計機能
  - [x] 引用履歴取得機能
  - _要件: 10.過去記録引用システム_

## PWA・オフライン対応

- [x] 13. Service Worker設定
  - [x] Vite PWA plugin設定と基本配置
  - [x] Workboxによるキャッシュ戦略
  - [x] Service Workerとマニフェスト自動生成
  - _要件: 6.PWA・オフライン対応システム_

- [x] 13.1 PWAマニフェスト
  - [x] アプリマニフェスト（manifest.webmanifest）の自動生成
  - [x] アイコン設定とPWA基本構成
  - [x] registerSW.jsの自動生成
  - _要件: 6.PWA・オフライン対応システム_

- [x] 13.2 オフライン機能
  - [x] オフライン状態検出
  - [x] IndexedDBによる一時保存
  - [x] オンライン復帰時の自動同期
  - [x] 競合解決システム
  - [x] offlineService.ts実装完了
  - _要件: 6.PWA・オフライン対応システム_

- [x] 13.3 自動更新システム
  - [x] 新バージョン検知機能
  - [x] 更新通知UI
  - [x] ユーザー選択による更新実行
  - [x] Service Worker統合
  - [x] updateService.ts、useAppUpdate.ts、UpdateNotification.tsx、UpdateSettings.tsx実装完了
  - _要件: 6.PWA・オフライン対応システム_

## プッシュ通知システム

- [x] 14. Firebase Messaging設定
  - [x] Firebase Cloud Messaging設定
  - [x] VAPID キーの設定
  - [x] Service Worker通知処理
  - [x] NotificationServiceクラス実装
  - [x] FCMトークン管理とユーザー登録
  - _要件: 7.プッシュ通知システム_

- [x] 14.1 通知管理機能
  - [x] 通知許可リクエスト
  - [x] 通知設定UI（種類別ON/OFF）
  - [x] 静寂時間設定（22:00-08:00）
  - [x] NotificationSettingsコンポーネント
  - [x] 通知テスト機能
  - _要件: 7.プッシュ通知システム_

- [x] 14.2 通知スケジューラー
  - [x] ストリークリマインダー
  - [x] クイズリマインダー
  - [x] ハート回復通知
  - [x] バッジ獲得通知
  - [x] AuthContext統合とユーザー初期化
  - _要件: 7.プッシュ通知システム_

## LLM連携・AI機能

- [x] 15. LLM API連携
  - [x] OpenRouter/Groq API設定
  - [x] パーソナライズドクイズ生成機能
  - [x] 味覚プロファイル分析機能
  - [x] ワイン推薦システム
  - [x] LLMServiceクラス実装
  - [x] 使用回数制限（無料：月10回、プレミアム：月100回）
  - _要件: 16.LLM連携・AI機能_

- [x] 15.1 AI機能UI
  - [x] AIクイズ生成ボタン
  - [x] 味覚分析レポート表示
  - [x] 使用回数制限表示（無料：月10回）
  - [x] AIAnalysisコンポーネント
  - [x] StatsPageへの統合
  - [x] 味覚プロフィール可視化
  - _要件: 16.LLM連携・AI機能_

- [x] 15.2 動的モデル切り替えシステム
  - [x] 複数LLMモデル対応（OpenRouter/Groq）
  - [x] リアルタイムモデル切り替え機能
  - [x] Firestoreベース設定管理
  - [x] AdminServiceクラス実装
  - [x] ModelSelectorコンポーネント
  - [x] 無料モデル対応（openai/gpt-oss-20b:free等）
  - [x] モデルテスト・パフォーマンス確認機能
  - [x] 設定ページ統合（AI設定タブ）
  - _要件: 16.LLM連携・AI機能_

## サブスクリプション・決済

- [ ] 16. Stripe統合準備
  - Stripe設定とWebhook準備
  - サブスクリプション状態管理
  - 有料プラン機能制限の実装
  - _要件: 8.サブスクリプション・有料機能システム_

- [ ] 16.1 プラン制限機能
  - 画像アップロード制限（無料：1枚、有料：4枚）
  - 記録数制限（無料：1ワインにつき2記録まで）
  - LLM API制限（無料：月10回）
  - _要件: 8.サブスクリプション・有料機能システム_

## セキュリティ・プライバシー

- [x] 17. Firestore Security Rules
  - [x] 181行の包括的セキュリティルール実装
  - [x] 認証・認可・データ検証関数
  - [x] 所有者限定アクセス制御
  - [x] プレミアムプラン制限統合
  - _要件: 12.セキュリティ・プライバシー保護_

- [x] 17.1 Storage Security Rules
  - [x] 階層別アクセス制御
  - [x] ファイルサイズ・形式制限
  - [x] 公開・非公開画像の適切な制御
  - [x] プレミアムユーザー向け大容量ファイル対応
  - _要件: 12.セキュリティ・プライバシー保護_

- [x] 17.2 プライバシー機能
  - [x] 公開・非公開設定UI
  - [x] 価格情報の非公開制御
  - [x] データエクスポート機能（GDPR対応）
  - [x] データ削除・匿名化機能
  - [x] privacyService.ts、PrivacySettings.tsx、DataExportDialog.tsx、DataDeletionDialog.tsx、PrivacyDashboard.tsx実装完了
  - _要件: 12.セキュリティ・プライバシー保護_

## デザイン・テーマシステム

- [x] 18. ダークテーマ実装
  - [x] CSS Custom Propertiesによるテーマシステム
  - [x] バー雰囲気のカラーパレット（#722F37等）
  - [x] レスポンシブデザイン（320px〜1920px）
  - [x] 全コンポーネントでダークテーマ対応完了
  - _要件: 20.レスポンシブデザイン・アクセシビリティ_

- [x] 18.1 BottomNavigationコンポーネント
  - [x] 5つのナビゲーションアイテム
  - [x] アクティブ状態のハイライト
  - [x] アクセシビリティ対応（aria-current）
  - _要件: 20.レスポンシブデザイン・アクセシビリティ_

- [x] 18.2 アクセシビリティ対応
  - [x] キーボードナビゲーション
  - [x] スクリーンリーダー対応（ARIA属性）
  - [x] フォーカス管理とアクセシビリティ属性
  - _要件: 20.レスポンシブデザイン・アクセシビリティ_

## CI/CD・自動デプロイ

- [ ] 19. GitHub Actions設定
  - Firebase Hosting自動デプロイワークフロー
  - 品質チェックワークフロー（テスト・リント・セキュリティ）
  - プレビューデプロイ（PR時）
  - _要件: CI/CD・自動デプロイ設計_

- [ ] 19.1 自動コミットスクリプト
  - Claude Code連携スクリプト（scripts/auto-commit.ts）
  - ビルドチェック → コミット → プッシュの自動化
  - インテリジェントなコミットメッセージ生成
  - _要件: CI/CD・自動デプロイ設計_

- [ ] 19.2 Git フック設定
  - Pre-commitフック（TypeScript・ESLint・テスト）
  - コミット品質の自動保証
  - VS Code タスク統合
  - _要件: CI/CD・自動デプロイ設計_

## 監視・運用機能

- [ ] 20. エラー追跡・監視
  - Sentry統合とエラー追跡
  - パフォーマンス監視（Core Web Vitals）
  - 構造化ログ管理
  - _要件: 監視・運用設計_

- [ ] 20.1 分析・KPI管理
  - ユーザー行動追跡
  - KPIダッシュボード（DAU、MAU、コンバージョン率）
  - A/Bテストフレームワーク
  - _要件: データ分析・ビジネスインテリジェンス設計_

## テスト実装

- [x] 21. 単体テスト
  - [x] Jest + Testing Library設定（ES modules対応）
  - [x] コンポーネントテスト（ErrorMessage、LoadingSpinner、Button、TagInput、ErrorBoundary、AIAnalysis）
  - [x] フックテスト（useErrorHandler、useDebounce）
  - [x] サービステスト（TastingRecordService、LLMService、CitationService）
  - [x] 70%テストカバレッジ目標設定と品質検証
  - [x] アクセシビリティテスト（ARIA属性、スクリーンリーダー対応）
  - _要件: 品質保証・テスト戦略_

- [ ] 21.1 E2Eテスト
  - Playwright設定
  - ワイン記録作成フローのテスト
  - クイズ完了フローのテスト
  - _要件: 品質保証・テスト戦略_

- [ ] 21.2 パフォーマンステスト
  - k6による負荷テスト
  - バンドルサイズ分析
  - Core Web Vitals測定
  - _要件: 品質保証・テスト戦略_

## 最終統合・デプロイ

- [ ] 22. 本番環境準備
  - 環境変数の設定
  - Firebase プロジェクトの本番設定
  - ドメイン設定（my-wine-memory.himazi.com）
  - _要件: 全体的な運用準備_

- [ ] 22.1 データ移行・初期化
  - 初期ユーザーデータの準備
  - クイズデータの投入
  - バッジ・レベル設定の確認
  - _要件: 全体的なデータ準備_

- [ ] 22.2 最終テスト・リリース
  - 全機能の統合テスト
  - パフォーマンス最終チェック
  - セキュリティ監査
  - 本番リリース
  - _要件: 全体的な品質保証_

---

## 🤖 LLM動的モデル切り替えシステム技術仕様

### 概要
本システムでは、複数のLLMプロバイダー（OpenRouter、Groq）の無料モデルを動的に切り替え可能な仕組みを実装。デプロイ後でもコード変更なしでAIモデルを変更できる。

### 対応モデル
```typescript
// デフォルトモデル: openai/gpt-oss-20b:free
const availableModels = [
  {
    id: 'openai-gpt-oss-free',
    name: 'GPT OSS 20B (無料)',
    provider: 'openrouter',
    modelId: 'openai/gpt-oss-20b:free',
    isFree: true
  },
  {
    id: 'openai-gpt4o-free', 
    modelId: 'openai/gpt-4o-mini-2024-07-18'
  },
  {
    id: 'meta-llama-free',
    modelId: 'meta-llama/llama-3.1-8b-instruct:free'
  },
  {
    id: 'mistral-free',
    modelId: 'mistralai/mistral-7b-instruct:free'
  },
  {
    id: 'groq-llama-free',
    provider: 'groq',
    modelId: 'llama-3.1-70b-versatile'
  }
]
```

### アーキテクチャ
```
[ユーザー] → [SettingsPage] → [ModelSelector] 
    ↓
[AdminService] → [Firestore(/appConfig/current)] 
    ↓
[LLMService] → [OpenRouter/Groq API]
```

### 設定ファイル構成
- **コード:** `src/services/llmService.ts` - モデル定義
- **DB:** `appConfig/current` - 現在のモデル設定
- **環境変数:** `VITE_OPENROUTER_API_KEY`, `VITE_GROQ_API_KEY`
- **UI:** 設定 > AI設定 > モデル選択

### 新しいモデル追加手順
1. `llmService.ts` の `getAvailableModelsList()` に追加
2. デプロイ後、設定画面から新モデルを選択
3. Firestoreに設定が自動保存、全ユーザーに即座に反映

### コスト管理
- 全モデル無料（使用回数制限のみ）
- 無料ユーザー: 月10回制限
- プレミアムユーザー: 月100回制限

### 運用メリット
- **ゼロダウンタイム切り替え:** リアルタイムでモデル変更
- **コスト最適化:** 無料モデル間での最適化
- **品質調整:** モデル性能に応じた柔軟な運用
- **フォールバック:** モデル障害時の自動復旧